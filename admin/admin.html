<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MB CMS — Admin</title>
  <meta name="robots" content="noindex,nofollow" />
  <link rel="stylesheet" href="../style.css" />
  <style>
    /* Small admin-only helpers (keeps your global style.css clean) */
    .center-box{ max-width: 520px; margin: 80px auto 0; }
    .cms-wrap{ padding: 18px 0 60px; }
    .cms-top{ display:flex; align-items:center; justify-content:space-between; gap:12px; flex-wrap:wrap; }
    .cms-title{ font-size: 20px; font-weight: 950; margin:0; }
    .cms-sub{ color: var(--muted); font-size: 13px; margin-top: 6px; }

    .grid{ display:grid; grid-template-columns: 1.2fr .8fr; gap: 14px; }
    @media (max-width: 980px){ .grid{ grid-template-columns: 1fr; } }

    .card{ background: var(--card); border: 1px solid var(--border); border-radius: var(--radius); box-shadow: var(--shadow2); }
    .card-pad{ padding: 14px; }

    .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; }
    .btn2{ border: 1px solid var(--border); background: rgba(255,255,255,.85); padding: 8px 12px; border-radius: 999px; font-weight: 900; font-size: 12px; cursor:pointer; color: var(--text); box-shadow: var(--shadow2); }
    body.dark .btn2{ background: rgba(255,255,255,.08); border-color: rgba(255,255,255,.14); color: rgba(255,255,255,.92); }
    .btn2.primary{ background: rgba(15,23,42,.92); color:white; border-color: rgba(15,23,42,.18); }
    body.dark .btn2.primary{ background: rgba(255,255,255,.92); color: rgba(15,23,42,.95); border-color: rgba(231,237,247,.18); }
    .btn2.danger{ background: rgba(239,68,68,.12); border-color: rgba(239,68,68,.35); }
    body.dark .btn2.danger{ background: rgba(239,68,68,.20); border-color: rgba(239,68,68,.45); }

    .input, .textarea, .select{
      width:100%;
      border: 1px solid var(--border);
      background: rgba(255,255,255,.92);
      border-radius: 14px;
      padding: 10px 12px;
      color: var(--text);
      font-weight: 700;
      outline:none;
      box-shadow: var(--shadow2);
    }
    body.dark .input, body.dark .textarea, body.dark .select{ background: rgba(255,255,255,.08); border-color: rgba(255,255,255,.14); }
    .textarea{ min-height: 110px; resize: vertical; }

    .drop{ border: 1px dashed var(--border); border-radius: 16px; padding: 18px; text-align:center; cursor:pointer; background: rgba(15,23,42,.03); }
    body.dark .drop{ background: rgba(255,255,255,.04); }
    .drop.drag{ border-color: rgba(15,23,42,.35); background: rgba(15,23,42,.06); }
    body.dark .drop.drag{ border-color: rgba(255,255,255,.25); background: rgba(255,255,255,.06); }
    .drop small{ display:block; margin-top: 6px; color: var(--muted); }

    .pill{ display:inline-flex; align-items:center; padding: 7px 10px; border-radius: 999px; border: 1px solid var(--border); background: rgba(15,23,42,.04); font-weight: 900; font-size: 12px; cursor:pointer; user-select:none; }
    body.dark .pill{ background: rgba(255,255,255,.08); border-color: rgba(255,255,255,.14); }
    .pill.on{ background: rgba(15,23,42,.92); color:white; border-color: rgba(15,23,42,.18); }
    body.dark .pill.on{ background: rgba(255,255,255,.92); color: rgba(15,23,42,.95); border-color: rgba(231,237,247,.18); }

    .posts{ display:flex; flex-direction:column; gap: 10px; }
    .post-item{ display:flex; gap: 10px; align-items:center; padding: 10px; border-radius: 16px; border: 1px solid var(--border); background: rgba(255,255,255,.72); cursor: pointer; }
    body.dark .post-item{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.14); }
    .thumb{ width: 64px; height: 48px; border-radius: 12px; object-fit: cover; background: rgba(15,23,42,.05); border: 1px solid var(--border); }
    body.dark .thumb{ background: rgba(255,255,255,.06); }
    .post-meta{ flex:1; min-width: 0; }
    .post-meta b{ display:block; font-size: 13px; }
    .post-meta span{ display:block; font-size: 12px; color: var(--muted); margin-top: 4px; white-space: nowrap; overflow:hidden; text-overflow: ellipsis; }
    .drag-hint{ font-size: 12px; color: var(--muted); }

    /* Analytics */
    .stats{ display:grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px; }
    @media (max-width: 560px){ .stats{ grid-template-columns: 1fr; } }
    .stat{ border: 1px solid var(--border); border-radius: 16px; padding: 10px 12px; background: rgba(15,23,42,.03); }
    body.dark .stat{ background: rgba(255,255,255,.06); border-color: rgba(255,255,255,.14); }
    .stat .k{ color: var(--muted); font-weight: 900; font-size: 12px; }
    .stat .v{ font-weight: 950; font-size: 20px; margin-top: 6px; }

    /* Gate */
    .center-title{ font-size: 20px; font-weight: 950; margin:0; }
    .center-sub{ color: var(--muted); margin-top: 6px; }
  </style>
</head>
<body>

  <!-- If no ?mbcms in the URL -->
  <div id="gate" class="card center-box" style="display:none;">
    <div class="card-pad">
      <p class="center-title">Not found</p>
      <p class="center-sub">This page is hidden.</p>
    </div>
  </div>

  <!-- Login -->
  <div id="login" class="card center-box" style="display:none;">
    <div class="card-pad">
      <p class="center-title">Admin login</p>
      <p class="center-sub">Enter the admin password.</p>
      <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap;">
        <input class="input" id="pw" type="password" placeholder="••••••••" style="flex:1; min-width: 220px;" />
        <button class="btn2 primary" id="loginBtn" type="button">Login</button>
      </div>
      <p class="center-sub" id="loginHint" style="margin-top:10px;"></p>
    </div>
  </div>

  <!-- App -->
  <main id="app" class="cms-wrap" style="display:none;">
    <div class="container">
      <div class="cms-top">
        <div>
          <h1 class="cms-title">MB CMS</h1>
          <div class="cms-sub">Local-only editor (saved in your browser).</div>
        </div>
        <div class="row">
          <button class="btn2" id="themeToggle" type="button">Dark</button>
          <button class="btn2" id="logoutBtn" type="button">Logout</button>
        </div>
      </div>

      <div style="height:14px"></div>

      <div class="grid">
        <!-- Editor -->
        <section class="card">
          <div class="card-pad">
            <div class="row" style="justify-content:space-between;">
              <h2 id="editorTitle" class="cms-title" style="font-size:16px;">Create post</h2>
              <span class="drag-hint" id="editId"></span>
            </div>

            <div style="height:10px"></div>

            <div id="drop" class="drop" tabindex="0">
              <b>Drop image</b> or click to upload
              <small>JPG/PNG/WebP recommended</small>
            </div>
            <input id="file" type="file" accept="image/*" hidden />

            <div style="height:12px"></div>

            <div class="row">
              <input class="input" id="title" type="text" placeholder="Optional title" />
            </div>

            <div style="height:10px"></div>

            <div class="row">
              <select class="select" id="category">
                <option value="Photography">Photography</option>
                <option value="Art">Art / Drawings</option>
              </select>
              <input class="input" id="schedule" type="datetime-local" />
            </div>

            <div style="height:10px"></div>

            <textarea class="textarea" id="caption" placeholder="Write a caption..."></textarea>

            <div style="height:10px"></div>

            <input class="input" id="tags" type="text" placeholder="#sunset #street #study" />

            <div style="height:10px"></div>

            <div class="row">
              <span class="pill" id="pillFeatured">Featured</span>
              <span class="pill" id="pillDraft">Draft</span>
            </div>

            <div style="height:12px"></div>

            <div class="row">
              <button class="btn2 primary" id="saveBtn" type="button">Publish</button>
              <button class="btn2" id="resetBtn" type="button">Reset</button>
              <button class="btn2 danger" id="deleteBtn" type="button" style="display:none;">Delete</button>
            </div>

            <div class="cms-sub" id="status" style="margin-top:10px;"></div>
          </div>
        </section>

        <!-- Right column -->
        <aside style="display:flex; flex-direction:column; gap: 14px;">
          <!-- Analytics card (separate, per your request) -->
          <section class="card" id="analyticsCard">
            <div class="card-pad">
              <h2 class="cms-title" style="font-size:16px; margin-bottom:6px;">Analytics</h2>
              <div class="cms-sub">Counts are based on what’s in your browser (localStorage).</div>
              <div class="stats">
                <div class="stat"><div class="k">Total posts</div><div class="v" id="countTotal">0</div></div>
                <div class="stat"><div class="k">Photography</div><div class="v" id="countPhoto">0</div></div>
                <div class="stat"><div class="k">Art / Drawings</div><div class="v" id="countArt">0</div></div>
                <div class="stat"><div class="k">Featured</div><div class="v" id="countFeatured">0</div></div>
                <div class="stat"><div class="k">Drafts</div><div class="v" id="countDraft">0</div></div>
                <div class="stat"><div class="k">Scheduled</div><div class="v" id="countScheduled">0</div></div>
              </div>
            </div>
          </section>

          <!-- Posts list + backup -->
          <section class="card">
            <div class="card-pad">
              <div class="row" style="justify-content:space-between;">
                <h2 class="cms-title" style="font-size:16px;">Posts</h2>
                <span class="drag-hint">Tip: drag to reorder</span>
              </div>
              <div style="height:10px"></div>
              <div class="row">
                <button class="btn2" id="exportBtn" type="button">Export</button>
                <button class="btn2 danger" id="wipeBtn" type="button">Wipe all</button>
              </div>
              <div style="height:12px"></div>
              <div id="posts" class="posts"></div>
            </div>
          </section>
        </aside>
      </div>
    </div>
  </main>

  <script src="admin.js"></script>
</body>
</html>
